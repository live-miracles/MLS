<!doctype html>
<html lang="en" data-theme="dim">
  <head>
    <meta charset="UTF-8" />
    <title>Dashboard</title>
    <link rel="icon" type="image/png" href="logo.png" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="output.css" />
    <script type="text/javascript" src="jsmpeg.min.js"></script>
    <script type="text/javascript" src="tools.js"></script>
    <script type="text/javascript" src="player.js"></script>
    <script type="text/javascript" src="pipeline.js"></script>
    <script type="text/javascript" src="dashboard.js" defer></script>
  </head>
  <body class="bg-base-100 text-base-content flex h-screen flex-col">
    <div class="navbar bg-base-100 shrink-0">
      <div class="flex-1">
        <button class="btn btn-ghost text-xl" id="server-name" onclick="selectPipeline(null)">MLS</button>
      </div>
      <div class="flex-none">
        <ul class="menu menu-horizontal px-1">
          <li><a href="/control.html" class="dynamic-params">Control</a></li>
          <li><a href="/settings.html" class="dynamic-params">Settings</a></li>
          <li>
            <a href="/stat" target="_blank" t>Stats</a>
          </li>
          <li><a href="/recording" target="_blank">Recordings</a></li>
          <li><a href="/config.php?proclist" target="_blank">Processes</a></li>
          <li><a href="https://github.com/isha-live/MLS" target="_blank">GitHub</a></li>
        </ul>
      </div>
    </div>

    <div role="alert" id="badConnectionAlert" class="alert alert-error fixed left-1/2 z-999 hidden w-96 -translate-x-1/2 transform opacity-90">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <span>Unable to connect to the server...</span>
    </div>

    <div class="grid h-screen min-h-0 flex-1 grid-cols-[200px_auto_1fr] gap-4 p-4 pt-0">
      <!-- Left Column -->
      <div class="bg-base-300 rounded-box w-full overflow-y-auto">
        <div id="pipe-overwiew" class="p-4">
          <div>
            <div aria-label="status" class="status status-success"></div>
            <span id="on-pipes"></span> pipes | <span id="on-outs"></span> outs
          </div>
          <div>
            <div aria-label="status" class="status status-error"></div>
            <span id="out-errors"></span> out errors
          </div>
          <div>
            <div aria-label="status" class="status status-warning"></div>
            <span id="out-warnings"></span> out warnings
          </div>
        </div>
        <ul class="menu rounded-box w-full" id="pipelines"></ul>
      </div>

      <!-- Middle Column -->
      <div class="bg-base-200 hidden overflow-y-auto rounded-xl p-4 shadow" id="pipe-info-col">
        <div class="stats server-stats shadow"></div>

        <div class="divider"></div>

        <div>
          <h2 class="mb-3 text-xl font-bold"><span id="pipe-name"></span> <span class="badge" id="input-time"></span></h2>

          <div class="jsmpeg text-center" id="video-player">
            <canvas width="300" height="169" id="video-canvas" class="inline border border-solid border-gray-400"></canvas>
            <p id="player-controls">
              <a href="javascript:void(0);" onclick="playVideo('player.php?appname=main&streamname=stream')" class="mx-1">
                <i class="material-icons text-3xl">play_arrow</i>M</a
              >
              <a href="javascript:void(0);" onclick="playVideo('player.php?appname=backup&streamname=stream')" class="mx-1">
                <i class="material-icons text-3xl">play_arrow</i>B</a
              >
              <a href="javascript:void(0);" onclick="playVideo('player.php?appname=distribute&streamname=stream')" class="mx-1">
                <i class="material-icons text-3xl">play_arrow</i>D</a
              >
              <a href="javascript:void(0);" onclick="jsmpegStop()" class="mx-1"><i class="material-icons text-3xl">stop</i></a>
              <a href="javascript:void(0);" onclick="jsmpegVolumeup()" class="mx-1"><i class="material-icons text-3xl">volume_up</i></a>
              <a href="javascript:void(0);" onclick="jsmpegVolumedown()" class="mx-1"><i class="material-icons text-3xl">volume_down</i></a>
            </p>
          </div>

          <div id="input-stats">
            <h2 class="text-lg">Video</h2>
            <div class="stats mt-1 shadow">
              <div class="stat p-3">
                <div class="stat-title">Codec</div>
                <div class="stat-value text-sm" id="input-video-codec"></div>
              </div>

              <div class="stat p-3">
                <div class="stat-title">Resolution</div>
                <div class="stat-value text-sm" id="input-video-resolution"></div>
              </div>

              <div class="stat p-3">
                <div class="stat-title">FPS</div>
                <div class="stat-value text-sm" id="input-video-fps"></div>
              </div>

              <div class="stat p-3">
                <div class="stat-title">Level</div>
                <div class="stat-value text-sm" id="input-video-level"></div>
              </div>

              <div class="stat p-3">
                <div class="stat-title">Profile</div>
                <div class="stat-value text-sm" id="input-video-profile"></div>
              </div>

              <div class="stat p-3">
                <div class="stat-title">Kb/s</div>
                <div class="stat-value text-sm" id="input-video-bw"></div>
              </div>
            </div>

            <h2 class="mt-3 text-lg">Audio</h2>
            <div class="stats mt-1 shadow">
              <div class="stat p-3">
                <div class="stat-title">Codec</div>
                <div class="stat-value text-sm" id="input-audio-codec"></div>
              </div>

              <div class="stat p-3">
                <div class="stat-title">Channels</div>
                <div class="stat-value text-sm" id="input-audio-channels"></div>
              </div>

              <div class="stat p-3">
                <div class="stat-title">Sample Rate</div>
                <div class="stat-value text-sm" id="input-audio-sample-rate"></div>
              </div>

              <div class="stat p-3">
                <div class="stat-title">Profile</div>
                <div class="stat-value text-sm" id="input-audio-profile"></div>
              </div>

              <div class="stat p-3">
                <div class="stat-title">Kb/s</div>
                <div class="stat-value text-sm" id="input-audio-bw"></div>
              </div>
            </div>
          </div>
          <div class="divider"></div>
          <div class="prose mt-2">
            <div>
              Server URL: <code id="server-url" data-copy=""></code>
              <button class="btn btn-xs btn-neutral" onclick="copyData('server-url')">ðŸ“‹</button>
            </div>
            <div class="mt-1">
              Stream Key: <code id="stream-key" data-copy=""></code>
              <button id="copy-btn" class="btn btn-xs btn-neutral" onclick="copyData('stream-key')">ðŸ“‹</button>
            </div>
            <div class="mt-1">
              RTMP URL: <code id="rtmp-url" data-copy=""></code>
              <button id="copy-btn" class="btn btn-xs btn-neutral" onclick="copyData('rtmp-url')">ðŸ“‹</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column -->
      <div class="bg-base-200 hidden overflow-y-auto rounded-xl p-4 shadow" id="outs-col">
        <h2 class="mb-3 text-xl font-bold">Outputs</h2>
        <div class="space-y-3" id="outputs-list"></div>
      </div>

      <!-- Stats Column -->
      <div class="bg-base-200 hidden overflow-y-auto rounded-xl p-4 shadow" id="stats-col">
        <div class="stats server-stats shadow"></div>

        <div class="divider"></div>

        <div class="overflow-x-auto">
          <table class="table">
            <!-- head -->
            <thead>
              <tr>
                <th>Time</th>
                <th>Name</th>
                <th>Kb/s</th>
                <th>Codec</th>
                <th>Size</th>
                <th>FPS</th>
                <th>Kb/s</th>
                <th>Codec</th>
                <th>Ch</th>
                <th>Freq</th>
              </tr>
            </thead>
            <tbody id="stats-table">
              <tr>
                <th>1</th>
                <td>Cy Ganderton</td>
                <td>Quality Control Specialist</td>
                <td>Blue</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </body>
</html>
